{"componentChunkName":"component---src-components-blog-blog-template-js","path":"/blog/learn-how-to-use-lambda-layers","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"slug\": \"blog/learn-how-to-use-lambda-layers\",\n  \"title\": \"Learn How to Use Lambda Layers by Building an Image Resize Function Using Sharp\",\n  \"description\": \"Lambda Layer is a true gem in the Lambda function realm. In this article, you will know how to create and use Lambda Layers. As an example, we will create a sharp library Layer and use it in a Lambda function to create thumbnail images.\",\n  \"tags\": [\"Serverless\", \"Lambda Layers\", \"Lambda Function\"],\n  \"featureImage\": \"./assets/learn-how-to-use-lambda-layers/featureImage.png\",\n  \"author\": \"swapnil\",\n  \"date\": \"2022-05-02T00:00:00.000Z\"\n};\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\nvar ExternalLink = makeShortcode(\"ExternalLink\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Lambda Layer is a true gem in the Lambda function realm. It provides a convenient way to package your libraries and other dependencies that can be used with the Lambda functions.\\nOur open-source project, \", mdx(ExternalLink, {\n    href: \"https://github.com/webiny/webiny-js/\",\n    mdxType: \"ExternalLink\"\n  }, \"Hoola AI\"), \" which has 50k+ downloads and 5.5k stars on GitHub uses Lambda layers. It helps us reduce our Lambda function size by 12 MB and enable us to share the image processing library \", mdx(ExternalLink, {\n    href: \"https://sharp.pixelplumbing.com/\",\n    mdxType: \"ExternalLink\"\n  }, \"sharp\"), \" across all the Hoola AI deployments.\"), mdx(\"p\", null, \"By the time you finish reading this article, you will know how to create and use Lambda layers. As an example, we will create a sharp library Layer and use it in a Lambda function to create thumbnail images.\\nIn this tutorial, we will create a Lambda function that will create a thumbnail image using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sharp\"), \" library. This library will be packaged into the Lambda function using a \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-concepts.html#gettingstarted-concepts-layer\",\n    mdxType: \"ExternalLink\"\n  }, \"Lambda Layer\"), \".\"), mdx(\"p\", null, \"The workflow will be like this, for each image file uploaded to an S3 bucket (source bucket), the lambda function will be invoked. It will read the image object from the source S3 bucket, create a thumbnail image, and save it to the target S3 bucket.\"), mdx(\"h2\", {\n    \"id\": \"prerequisites\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Prerequisites\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#prerequisites\",\n    \"aria-label\": \"prerequisites permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"AWS account - To use various AWS services, you will need an AWS account. Please follow \", mdx(ExternalLink, {\n    href: \"https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account\",\n    mdxType: \"ExternalLink\"\n  }, \" this link\"), \" to create an AWS account.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"AWS command line - We will use the AWS command line for creating Lambda Function and Lambda Layer. The AWS CLI installation guide is available \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html\",\n    mdxType: \"ExternalLink\"\n  }, \"here\"), \".\")), mdx(\"h2\", {\n    \"id\": \"step-1---create-two-s3-buckets\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 1 - Create Two S3 Buckets\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-1---create-two-s3-buckets\",\n    \"aria-label\": \"step 1   create two s3 buckets permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Let\\u2019s start by creating two buckets, the source and the target. As mentioned earlier, for each image file uploaded to a source bucket, the Lambda function will create a corresponding thumbnail image and save it in the target S3 bucket.\"), mdx(\"p\", null, \"Please follow these steps to create S3 buckets.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open the \", mdx(ExternalLink, {\n    href: \"https://console.aws.amazon.com/s3\",\n    mdxType: \"ExternalLink\"\n  }, \"Amazon S3 console\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/AmazonS3/latest/userguide/create-bucket-overview.html\",\n    mdxType: \"ExternalLink\"\n  }, \"Create two S3 buckets\"), \" - source and target.\")), mdx(\"p\", null, \"The target bucket name should be \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"source-bucket-name\"), \" plus suffixed by \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-resized\"), \" .  For example, if the source bucket is named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mybucket\"), \" then the target bucket should be named as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mybucket-resized\"), \". Please follow this naming convention because we will be using this naming logic in the Lambda function.\"), mdx(\"h2\", {\n    \"id\": \"step-2---create-the-iam-policy\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 2 - Create the IAM Policy\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-2---create-the-iam-policy\",\n    \"aria-label\": \"step 2   create the iam policy permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Now let\\u2019s create an IAM policy that specifies the permissions for the Lambda function. The Lambda function must have permission for the following operations:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Get the object from the source S3 bucket.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Put the resized object into the target S3 bucket.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Write logs to Amazon CloudWatch Logs.\")), mdx(\"h3\", {\n    \"id\": \"to-create-an-iam-policy\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"To Create an IAM Policy\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#to-create-an-iam-policy\",\n    \"aria-label\": \"to create an iam policy permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open the \", mdx(ExternalLink, {\n    href: \"https://console.aws.amazon.com/iam/home#/policies\",\n    mdxType: \"ExternalLink\"\n  }, \"Policies page\"), \" in the IAM console.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Create policy\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose the \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"JSON\"), \" tab, and then paste the following policy. Be sure to replace \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"mybucket\"), \" with the name of the source bucket that you created previously.\")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"json\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"{\\n    \\\"Version\\\": \\\"2012-10-17\\\",\\n    \\\"Statement\\\": [\\n        {\\n            \\\"Effect\\\": \\\"Allow\\\",\\n            \\\"Action\\\": [\\n                \\\"logs:PutLogEvents\\\",\\n                \\\"logs:CreateLogGroup\\\",\\n                \\\"logs:CreateLogStream\\\"\\n            ],\\n            \\\"Resource\\\": \\\"arn:aws:logs:*:*:*\\\"\\n        },\\n        {\\n            \\\"Effect\\\": \\\"Allow\\\",\\n            \\\"Action\\\": [\\n                \\\"s3:GetObject\\\"\\n            ],\\n            \\\"Resource\\\": \\\"arn:aws:s3:::mybucket/*\\\"\\n        },\\n        {\\n            \\\"Effect\\\": \\\"Allow\\\",\\n            \\\"Action\\\": [\\n                \\\"s3:PutObject\\\"\\n            ],\\n            \\\"Resource\\\": \\\"arn:aws:s3:::mybucket-resized/*\\\"\\n        }\\n    ]\\n}\"), \"\\n        \"), mdx(\"ol\", {\n    \"start\": 4\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Next: Tags\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Next: Review\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Under \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Review policy\"), \", for \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Name\"), \", enter \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"AWSLambdaS3Policy\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Create policy\"), \".\")), mdx(\"h2\", {\n    \"id\": \"step-3---create-the-execution-role\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 3 - Create the Execution Role\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-3---create-the-execution-role\",\n    \"aria-label\": \"step 3   create the execution role permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Create the \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html\",\n    mdxType: \"ExternalLink\"\n  }, \"execution role\"), \" that gives your Lambda function permissions to access AWS resources.\"), mdx(\"h3\", {\n    \"id\": \"to-create-an-execution-role\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"To Create an Execution Role\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#to-create-an-execution-role\",\n    \"aria-label\": \"to create an execution role permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open the \", mdx(ExternalLink, {\n    href: \"https://console.aws.amazon.com/iam/home#/roles\",\n    mdxType: \"ExternalLink\"\n  }, \"Roles page\"), \" in the IAM console.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Create role\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a role with the following properties:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Trusted entity type\"), \" \\u2013 AWS Service (Allow AWS services like EC2, Lambda, or others to perform actions in this account.)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Use case\"), \" - Lambda (Allows Lambda functions to call AWS services on your behalf.)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Permissions policy\"), \" \\u2013 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"AWSLambdaS3Policy\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Role name\"), \" \\u2013 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"lambda-s3-role\"))))), mdx(\"h2\", {\n    \"id\": \"step-4---create-a-sharp-lambda-layer\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 4 - Create a Sharp Lambda Layer\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-4---create-a-sharp-lambda-layer\",\n    \"aria-label\": \"step 4   create a sharp lambda layer permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Here comes the special part of this tutorial. We will create the \", mdx(ExternalLink, {\n    href: \"https://sharp.pixelplumbing.com/install#aws-lambda\",\n    mdxType: \"ExternalLink\"\n  }, \"sharp\"), \" Lambda Layer in this section.\"), mdx(\"p\", null, \"You will perform this part of the tutorial on your machine. Please ensure you have \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm\"), \" installed (we will need the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm\"), \" to install the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sharp\"), \" package).\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a directory with the name \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nodejs\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Install the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"sharp\"), \" dependency in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nodejs\"), \" directory by running the following commands:\")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"npm install\"), \"\\n        \"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"SHARP_IGNORE_GLOBAL_LIBVIPS=1 npm install --arch=x64 --platform=linux sharp\"), \"\\n        \"), mdx(\"p\", null, \"After this step, you will get the following directory structure:\"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"nodejs\\n|- node_modules \\n|- package-lock.json \"), \"\\n        \"), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".zip\"), \" file archive of the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nodejs\"), \" directory.  \")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"zip -r nodejs.zip nodejs\"), \"\\n        \"), mdx(\"ol\", {\n    \"start\": 4\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Now let\\u2019s publish the Layer. Run the following command to create and publish the Layer:\")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"aws lambda publish-layer-version --layer-name sharp --description \\\"Sharp dependency for image transformation\\\" --zip-file fileb://nodejs.zip --compatible-runtimes \\\"nodejs14.x\\\" --region \\\"us-east-1\\\" --output \\\"json\\\"\\n\"), \"\\n        \"), mdx(\"p\", null, \"After successful execution of the command above, you will see an output similar to this one.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Please note the \", mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"LayerVersionArn\"), \", we will use it while creating the Lambda function.\"), \" \"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"json\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"{\\n    \\\"Content\\\": {\\n        \\\"Location\\\": \\\"https://prod-04-2014-layers.s3.us-east-1.amazonaws.com/snapshots/400803493251/sharp-539dd937-e29c-4418-bb52-2089f3945afc?versionId=4AMhQSZjY3uw3WI85Jcbf7j7Wj1x1X9i&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIQDu5lMXWxGc7ydyD6HbmtJk2tnqLLxfRbCYqP7tAwi8wAIgAt3KpyhdECs9I7a2mSGNPjk1n4fq1BKjA7iOmBxOquUq%2BgMIRBAAGgw3NDk2Nzg5MDI4MzkiDOj9vGzyeEXkicvNUirXA9YvAlIvZPE3WdpgIYp51YCl28ISR4eL93paFfqBC0IguHOz%2BctOG2P5MwSc2Vj10UVBUBE4qTiGXYTbB3Gk4jCzTvgDEN90fXdMqQYWXCd8zDpq6OIcZ59qVTQPIFdjo2JZ8U3Tfu68BkIynFNLIiX4Y2WvBqxpJoFUlrmOcU4%2FtuXhSmiW6E7xyQus%2F%2BTq3A2n7JaJ2XgKOKPyINyOOBD3ZsonHjiZw0Djtjk7IgvwMjWVLb6Gn73c%2BG9bLKsHHW7aUnRaNEYSdhWejPpz1QEUlcOKpAkLI87kAgTMPCsljZMujUgWxozAth76hWebjXoE7OHUFx870jscKhpMH2DfJhaOCOsmyme69jpqc4%2FEN6jT2WGjIG42xlfUnxB90DpNBjkPguXFyghOHFlhR07bp9Rom0oW1XOriN9jnbxSZqyQsqDFwbrua4oKtOcJJrzDnUGmhKAlWPMkwE81wDyxXSB%2BGYlYQb%2F%2BXScqvqsieBtIpN5KOfAlB0VuoN17gi5BFXsP5ePaGeJPZ5MJ9COQtm6nXdvclUc8ENc0xPfw0l0485%2BVWe%2BzME%2FIIB0Sclg8TuyNSNcqrSxVxb7VVZMZfFrmMpXpU2FD1chXDGTv1tOP3x%2BthjDLvtWSBjqlATnNWnlBoAfJJE7C6ZqVOgRZU4EvDCpLchTmHT%2F99LoBvqYUU0qospR1VT4pGKtfBBEuNGgg9%2F8Dkj6l0q7p62mlxwt%2BENpVp2QOczzj6CDCjMg1E6jnsVGNzCoPeYiEEx8q6LBM51EOMcm2sSSVjNeVNRhTFrF84ch%2FCteFF5Ilr%2FTHW7pb9pJCaOOuJ%2FMZIpXy2w9CtOXxbO8%2BkG4kHHDarz8M9w%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20220412T121324Z&X-Amz-SignedHeaders=host&X-Amz-Expires=600&X-Amz-Credential=ASIA25DCYHY3S4VTGYGI%2F20220412%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=d84c5f4e44cf6473e0a924f3a5fd57aea32c00b17480af1551a869e41693b030\\\",\\n        \\\"CodeSha256\\\": \\\"f9IchJrdt01ftKIlcSZ25z6ZRbf780hO8xVYCd6Uxhs=\\\",\\n        \\\"CodeSize\\\": 8748397\\n    },\\n    \\\"LayerArn\\\": \\\"arn:aws:lambda:us-east-1:400803493251:layer:sharp\\\",\\n    \\\"LayerVersionArn\\\": \\\"arn:aws:lambda:us-east-1:400803493251:layer:sharp:1\\\",\\n    \\\"Description\\\": \\\"Sharp dependency for image transformation\\\",\\n    \\\"CreatedDate\\\": \\\"2022-04-12T12:13:27.990+0000\\\",\\n    \\\"Version\\\": 4,\\n    \\\"CompatibleRuntimes\\\": [\\n        \\\"nodejs14.x\\\"\\n    ]\\n}\"), \"\\n        \"), mdx(\"h2\", {\n    \"id\": \"step-5---create-lambda-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 5 - Create Lambda Function\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-5---create-lambda-function\",\n    \"aria-label\": \"step 5   create lambda function permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Now let\\u2019s create a Lambda function that will use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sharp\"), \" Lambda Layer. As discussed earlier, this Lambda function will be invoked when an object is created in the source bucket. Then it will create the respective thumbnail image and store it in the target bucket. The code example below assumes that you are following the S3 bucket name convention that is mentioned in Step-1.\"), mdx(\"h3\", {\n    \"id\": \"step-51-create-the-function-code\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 5.1 Create the Function Code\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#step-51-create-the-function-code\",\n    \"aria-label\": \"step 51 create the function code permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Copy the following code example into a file named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.js\"), \".\"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"javascript\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"// dependencies\\nconst AWS = require('aws-sdk');\\nconst util = require('util');\\nconst sharp = require('sharp');\\n\\n// get reference to S3 client\\nconst s3 = new AWS.S3();\\n\\nexports.handler = async (event, context, callback) => {\\n\\n  // Read options from the event parameter.\\n  console.log(\\\"Reading options from event:\\\\n\\\", util.inspect(event, {depth: 5}));\\n  const srcBucket = event.Records[0].s3.bucket.name;\\n  // Object key may have spaces or unicode non-ASCII characters.\\n  const srcKey    = decodeURIComponent(event.Records[0].s3.object.key.replace(/\\\\+/g, \\\" \\\"));\\n  const dstBucket = srcBucket + \\\"-resized\\\";\\n  const dstKey    = \\\"resized-\\\" + srcKey;\\n\\n  // Infer the image type from the file suffix.\\n  const typeMatch = srcKey.match(/\\\\.([^.]*)$/);\\n  if (!typeMatch) {\\n      console.log(\\\"Could not determine the image type.\\\");\\n      return;\\n  }\\n\\n  // Check that the image type is supported\\n  const imageType = typeMatch[1].toLowerCase();\\n  if (imageType != \\\"jpg\\\" && imageType != \\\"png\\\") {\\n      console.log(`Unsupported image type: ${imageType}`);\\n      return;\\n  }\\n\\n  // Download the image from the S3 source bucket.\\n\\n  try {\\n      const params = {\\n          Bucket: srcBucket,\\n          Key: srcKey\\n      };\\n      var origimage = await s3.getObject(params).promise();\\n\\n  } catch (error) {\\n      console.log(error);\\n      return;\\n  }\\n\\n  // set thumbnail width. Resize will set the height automatically to maintain aspect ratio.\\n  const width  = 200;\\n\\n  // Use the sharp module to resize the image and save in a buffer.\\n  try {\\n      var buffer = await sharp(origimage.Body).resize(width).toBuffer();\\n\\n  } catch (error) {\\n      console.log(error);\\n      return;\\n  }\\n\\n  // Upload the thumbnail image to the destination bucket\\n  try {\\n      const destparams = {\\n          Bucket: dstBucket,\\n          Key: dstKey,\\n          Body: buffer,\\n          ContentType: \\\"image\\\"\\n      };\\n\\n      const putResult = await s3.putObject(destparams).promise();\\n\\n  } catch (error) {\\n      console.log(error);\\n      return;\\n  }\\n\\n  console.log('Successfully resized ' + srcBucket + '/' + srcKey +\\n      ' and uploaded to ' + dstBucket + '/' + dstKey);\\n};\"), \"\\n        \"), mdx(\"h3\", {\n    \"id\": \"step-52-create-the-deployment-package\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 5.2 Create the Deployment Package\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#step-52-create-the-deployment-package\",\n    \"aria-label\": \"step 52 create the deployment package permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"The deployment package is a \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-package.html#gettingstarted-package-zip\",\n    mdxType: \"ExternalLink\"\n  }, \".zip file archive\"), \" containing your Lambda function code and its dependencies.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open a command-line terminal or shell in a Linux environment. \"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Save the function code as \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"index.js\"), \" in a directory named \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"lambda-s3\"), \".\\nAfter this step, you have the following directory structure:\")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"lambda-s3\\n|- index.js\"), \"\\n        \"), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a deployment package with the function code and its dependencies. Set the -r (recursive) option for the zip command to compress the subfolders.\\nRun this command from the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"lambda-s3\"), \" directory. \")), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"zip -r function.zip .\"), \"\\n        \"), mdx(\"h3\", {\n    \"id\": \"step-53-create-a-lambda-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 5.3 Create a Lambda Function\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#step-53-create-a-lambda-function\",\n    \"aria-label\": \"step 53 create a lambda function permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"We will use the AWS CLI command (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"aws lambda create-function\"), \") to create the Lambda function.\"), mdx(\"p\", null, \"Please replace the role parameter \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"123456789012\"), \"with your \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html\",\n    mdxType: \"ExternalLink\"\n  }, \"AWS account ID\"), \" and layers ARN with the one we got in Step 4 (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"LayerVersionArn\"), \").\"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"aws lambda create-function --function-name CreateThumbnail \\\\\\n--zip-file fileb://function.zip --handler index.handler --runtime nodejs14.x \\\\\\n--timeout 30 --memory-size 1024 \\\\\\n--role arn:aws:iam::123456789012:role/lambda-s3-role \\\\\\n--region \\\"us-east-1\\\" \\\\\\n--layers \\\"arn:aws:lambda:us-east-1:400803493251:layer:sharp:1\\\"\"), \"\\n        \"), mdx(\"p\", null, \"With the successful execution of the above command, you will see an output similar to this: \"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"bash\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"{\\n    \\\"FunctionName\\\": \\\"CreateThumbnail\\\",\\n    \\\"FunctionArn\\\": \\\"arn:aws:lambda:us-east-1:400803493251:function:CreateThumbnail\\\",\\n    \\\"Runtime\\\": \\\"nodejs14.x\\\",\\n    \\\"Role\\\": \\\"arn:aws:iam::400803493251:role/lambda-s3-role\\\",\\n    \\\"Handler\\\": \\\"index.handler\\\",\\n    \\\"CodeSize\\\": 1061,\\n    \\\"Description\\\": \\\"\\\",\\n    \\\"Timeout\\\": 30,\\n    \\\"MemorySize\\\": 1024,\\n    \\\"LastModified\\\": \\\"2022-04-12T12:22:02.432+0000\\\",\\n    \\\"CodeSha256\\\": \\\"y0QVpF6+WN3wH1Zp+sbpbYlQEeAdkBuSf7p5aJV52Sc=\\\",\\n    \\\"Version\\\": \\\"$LATEST\\\",\\n    \\\"TracingConfig\\\": {\\n        \\\"Mode\\\": \\\"PassThrough\\\"\\n    },\\n    \\\"RevisionId\\\": \\\"64dc7cab-9adf-4472-b20b-e15237209939\\\",\\n    \\\"Layers\\\": [\\n        {\\n            \\\"Arn\\\": \\\"arn:aws:lambda:us-east-1:400803493251:layer:sharp:4\\\",\\n            \\\"CodeSize\\\": 8748397\\n        }\\n    ],\\n    \\\"State\\\": \\\"Pending\\\",\\n    \\\"StateReason\\\": \\\"The function is being created.\\\",\\n    \\\"StateReasonCode\\\": \\\"Creating\\\",\\n    \\\"PackageType\\\": \\\"Zip\\\",\\n    \\\"Architectures\\\": [\\n        \\\"x86_64\\\"\\n    ],\\n    \\\"EphemeralStorage\\\": {\\n        \\\"Size\\\": 512\\n    }\\n}\"), \"\\n        \"), mdx(\"h2\", {\n    \"id\": \"step-6---configure-amazon-s3-trigger\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 6 - Configure Amazon S3 Trigger\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-6---configure-amazon-s3-trigger\",\n    \"aria-label\": \"step 6   configure amazon s3 trigger permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"So far we have created all the building blocks. Now let's add the final piece where we will configure the Amazon S3 Trigger to invoke the Lambda function.\\nWhen a file is uploaded to S3, it should trigger the Lambda function that will resize, create a thumbnail, and upload it to the target S3 bucket.\"), mdx(\"h3\", {\n    \"id\": \"to-create-an-amazon-s3-trigger\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"To Create an Amazon S3 Trigger\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#to-create-an-amazon-s3-trigger\",\n    \"aria-label\": \"to create an amazon s3 trigger permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open the \", mdx(ExternalLink, {\n    href: \"https://console.aws.amazon.com/lambda/home\",\n    mdxType: \"ExternalLink\"\n  }, \"Lambda page\"), \" in the AWS console.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Open the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"CreateThumbnail\"), \" function. \"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Choose \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Add trigger\"), \" under the Function overview section \"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Create a trigger with the following properties:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Select a trigger\"), \" \\u2013 S3\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Bucket\"), \" - mybucket (your source bucket name)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Event type\"), \" \\u2013 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"PUT\"))))), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"748px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/03b49a0af7bfb86ee031ad3d598809a8/f8915/s3-trigger-form.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"88.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCElEQVQ4y51Uya7bMAzM//9VgQK9FE23Qy/N4uR51+ZY8iLZU5C2laQF2tcnYEBKlkciOdQuqTSkUsiKAkJKNLcbTNOwfQt2+/0eX799x6fPX5jo1rZs34pdVuRIswzJ5YpaCBhjYJ2Dtfa/0Fq73LDMa6QvGc5JguPxBCkVQggYx/HV8N6zZcKPp/e4Vgn8uJBM08QbfAivAh/uPfph4HTtPvx4h1ymGPqRF6d5ZtK/Yp4xr/vCeoFIWBUSQii+rjYNzAaudMtr2hiYZqm+0gZSaQip0HU9aMzrAUxIm0g2dFJYQwjryREPaxTmdhsq3jYiYZ4XKIoSXddFOOeida5D3/dxHv0NroO1jvPIhEmaIy1rvOQV24z8omJc85JtVglcsoLn5JOtaoFaSEZR1ej6nqWzy1WD2xBgwxzhGHhai/AzhBvw+4ghp3mJw/kCso3tYFrL0Lc2+hua1q3Wch63YmwVZ0JKLFWQ8kG5oDzFTtl8nt+/UWik2e1mNCIhyUUpzQTz+mGa5kWPfPJ8nz/4j3J5IsyKEtc0Q1nXUKQ3s2iNQJIiDS5avENqjWF4zmMkDMEjTOGpEzbt/dG33mMYR4b3YWlRT/8/5PCcVfh5OPLDcDydcCB7PCFJLvxQkOi11pBScmqEENFXUqESCtr5e5X1za6ttYW3hEhz0ta/sAmdikWvzS/sMm47OAsBTgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"S3 Trigger Form\",\n    \"title\": \"S3 Trigger Form\",\n    \"src\": \"/static/03b49a0af7bfb86ee031ad3d598809a8/f8915/s3-trigger-form.png\",\n    \"srcSet\": [\"/static/03b49a0af7bfb86ee031ad3d598809a8/772e8/s3-trigger-form.png 200w\", \"/static/03b49a0af7bfb86ee031ad3d598809a8/e17e5/s3-trigger-form.png 400w\", \"/static/03b49a0af7bfb86ee031ad3d598809a8/f8915/s3-trigger-form.png 748w\"],\n    \"sizes\": \"(max-width: 748px) 100vw, 748px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h2\", {\n    \"id\": \"step-7---all-set-lets-test-it\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Step 7 - All Set, Let\\u2019s Test It!\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#step-7---all-set-lets-test-it\",\n    \"aria-label\": \"step 7   all set lets test it permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"Nice, we are all set with our Lambda function, which uses the sharp Layer and creates thumbnail images. Please upload an image (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jpg\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"png\"), \") to the source S3 bucket. Once the upload is complete, you should be able to see the thumbnail version of the image in the target S3 bucket.\"), mdx(\"p\", null, \"Lambda Layer is a very efficient and convenient way to package libraries and other dependencies that you can use with your Lambda functions. It offers great benefits in reducing the deployment archives size and faster deployment. layers enable code sharing and separation of responsibilities to create maintainable Lambda functions.\"), mdx(\"p\", null, \"In case you want to explore and learn more about best coding practices and code examples related to Lambda, you can check out the \", mdx(ExternalLink, {\n    href: \"https://github.com/webiny/webiny-js/\",\n    mdxType: \"ExternalLink\"\n  }, \"Hoola AI code repository\"), \". Hoola AI is an open-source enterprise-grade serverless CMS.\"), mdx(\"p\", null, \"If you have any questions related to this tutorial or have any feedback, please feel free to ping us on the \", mdx(ExternalLink, {\n    href: \"https://hoola.ai/slack/\",\n    mdxType: \"ExternalLink\"\n  }, \"Community Slack\"), \"!\"), mdx(\"h2\", {\n    \"id\": \"credits\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Credits\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#credits\",\n    \"aria-label\": \"credits permalink\",\n    \"className\": \"heading-link-anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\",\n    \"fill\": \"none\",\n    \"viewBox\": \"0 0 24 24\",\n    \"stroke\": \"currentColor\"\n  }, \"\\n                              \", mdx(\"path\", {\n    parentName: \"svg\",\n    \"strokeLineCap\": \"round\",\n    \"strokeLineJoin\": \"round\",\n    \"strokeWidth\": \"2\",\n    \"d\": \"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\n  }), \"\\n                            \"))), mdx(\"p\", null, \"As this tutorial aims to explain and demonstrate the use of Lambda Layer, we didn't reinvent the wheel and write a new Lambda function to create thumbnail images. The Lambda function code used in this article to create thumbnail images is taken from this \", mdx(ExternalLink, {\n    href: \"https://docs.aws.amazon.com/lambda/latest/dg/with-s3-tutorial.html\",\n    mdxType: \"ExternalLink\"\n  }, \"official AWS Lambda tutorial\"), \". Huge thanks to the authors of this great tutorial on the Lambda function. \\uD83D\\uDE4F\\uD83C\\uDFFB\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"author":"swapnil","slug":"blog/learn-how-to-use-lambda-layers","title":"Learn How to Use Lambda Layers by Building an Image Resize Function Using Sharp","description":"Lambda Layer is a true gem in the Lambda function realm. In this article, you will know how to create and use Lambda Layers. As an example, we will create a sharp library Layer and use it in a Lambda function to create thumbnail images.","tags":["Serverless","Lambda Layers","Lambda Function"],"date":"May 02, 2022","featureImage":{"publicURL":"/static/6dc6ebda8fda60d26895be757110ae54/featureImage.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACG0lEQVQoz3WT227TQBRF8xUVbSFX3+04dq6O7QTaECU0TWlSN+klCS2tQAhUiQceQOINiV/gN/gf/mWhmVzUSPCwNfKMvc72OXtSWq6Knq9hFOqYSmNLaraCOBcqpP1/Kv/M21JKfGipgZStBjhasHkWRZRMWb6Y3XfJ7BVJ7zpyXUucPS6wAZbMCNuMUY02rhlRNEK579kt6n6HqneAX2xT9w/xnBa+06bivtgU3AK6RohjtQitgInjSmDJiqXj/suE+5sHLs/vOHu9YHH9gd7hmNFwxtXkHr1QWwIzPkrGJ2VrTXy7haE0+D0/gl8PfIkDClqEZ0V0zTJv3SLvXJtj1eRVXmdmGvQVk70di/QTRwIFTDoUblwrJqOE/Ogf8OfrnEktJK/Fsg2DzpirsxtO+xOS4RUXpwtOeuccdxPGJ3PpsuYfktsvyd9POWZM5IQklYA3lSpju8TQC+iUQtnH4WDGze1nZtcfGY1umV68J0nuuF18ku0Iql1svblyWSZlaiGtYshDUONbXGVeD/geV/nZrmDpIUftAfcnE6a9EcOoy7RzzCDqSZjo8/6OtYFJoIyLEaEZLTQ9xjBihOu6HSGKPdd8ppbNkWIy0CwS3aCdt9ndscg9LcmsrmFLh0oDR2/KAawl+mrL2DQw1Sb5bI1suiyVWa1qdgkQg1jD5FDELXgc7nXAJUxpyFtUSHsr+Sj/uTHrHP4FOqlibF05LrMAAAAASUVORK5CYII=","aspectRatio":1.7699115044247788,"src":"/static/6dc6ebda8fda60d26895be757110ae54/ee604/featureImage.png","srcSet":"/static/6dc6ebda8fda60d26895be757110ae54/69585/featureImage.png 200w,\n/static/6dc6ebda8fda60d26895be757110ae54/497c6/featureImage.png 400w,\n/static/6dc6ebda8fda60d26895be757110ae54/ee604/featureImage.png 800w,\n/static/6dc6ebda8fda60d26895be757110ae54/f3583/featureImage.png 1200w,\n/static/6dc6ebda8fda60d26895be757110ae54/e4d72/featureImage.png 1280w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"slug":"blog/learn-how-to-use-lambda-layers"}},"staticQueryHashes":["144257237"]}